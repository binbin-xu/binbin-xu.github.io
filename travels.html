<!DOCTYPE html>
<html lang="en">
<!--
    ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ
    üåç TRAVEL MAP - Easy Maintenance Page
    ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ
    
    üìù TO UPDATE YOUR TRAVELS:
       ‚Üí Edit: travel-data.js
       ‚Üí Add/remove countries there
      <script src="https://d3js.org/d3.v7.min.js"></script>
    <script src="https://d3js.org/topojson.v3.min.js"></script>
    <script src="travel-data.js"></script>
    <script>
        // ============================================================================
        // üîß AUTO-GENERATED DATA - Everything updates automatically from travel-data.js
        // ============================================================================Everything updates automatically!
    
    üìñ FULL GUIDE: See TRAVEL_README.md
    üöÄ QUICK START: See TRAVEL_CHEAT_SHEET.txt
    
    ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ
-->
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>My Travel Map - Binbin Xu</title>
    <link rel="stylesheet" type="text/css" href="css/main.css">
    <style>
        body {
            margin: 0;
            padding: 0;
            font-family: 'open-sans', sans-serif;
            background-color: #ffffff;
            color: #404040;
            font-size: 14pt;
        }

        .travel-container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
        }

        .travel-header {
            text-align: center;
            padding: 40px 20px;
            background: #f8f8f8;
            border-radius: 0px;
            margin-bottom: 30px;
            border-bottom: 2px solid #e0e0e0;
        }

        .travel-header h1 {
            font-family: 'league-gothic', sans-serif;
            font-size: 56px;
            font-weight: 550;
            margin: 0 0 10px 0;
            color: #000000;
            text-indent: -3px;
            line-height: 54pt;
        }

        .travel-header p {
            font-family: 'open-sans', sans-serif;
            font-size: 16pt;
            font-weight: 300;
            color: #404040;
            margin: 10px 0;
            line-height: 20pt;
        }

        .stats-container {
            display: flex;
            justify-content: center;
            gap: 40px;
            margin-top: 20px;
            flex-wrap: wrap;
        }

        .stat-box {
            background: #ffffff;
            padding: 20px 40px;
            border-radius: 0px;
            border: 1px solid #e0e0e0;
        }

        .stat-number {
            font-family: 'league-gothic', sans-serif;
            font-size: 48px;
            font-weight: 600;
            color: #000000;
        }

        .stat-label {
            font-family: 'open-sans', sans-serif;
            font-size: 14pt;
            color: #404040;
            margin-top: 5px;
        }

        .map-container {
            background: #f8f8f8;
            border-radius: 0px;
            padding: 30px;
            border: 1px solid #e0e0e0;
            margin-bottom: 30px;
        }

        #worldMap {
            width: 100%;
            height: 600px;
            border-radius: 0px;
            background: #ffffff;
            border: 1px solid #e0e0e0;
        }

        .regions-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .region-card {
            background: #f8f8f8;
            border-radius: 0px;
            padding: 25px;
            border: 1px solid #e0e0e0;
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }

        .region-card:hover {
            transform: translateY(-3px);
            box-shadow: 0 4px 8px rgba(0,0,0,0.1);
            border-color: #404040;
        }

        .region-title {
            font-family: 'league-gothic', sans-serif;
            font-size: 36px;
            font-weight: 600;
            color: #000000;
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .region-icon {
            font-size: 1.5em;
        }

        .country-list {
            list-style: none;
            padding: 0;
            margin: 0;
        }

        .country-item {
            font-family: 'open-sans', sans-serif;
            font-size: 14pt;
            padding: 8px 0;
            border-bottom: 1px solid #e0e0e0;
            display: flex;
            align-items: center;
            gap: 10px;
            color: #404040;
        }

        .country-item:last-child {
            border-bottom: none;
        }

        .country-flag {
            font-size: 1.5em;
        }

        .back-link {
            display: inline-block;
            margin-top: 30px;
            padding: 12px 30px;
            background: #000000;
            color: #ffffff;
            text-decoration: none;
            border-radius: 0px;
            font-family: 'open-sans', sans-serif;
            font-weight: 400;
            font-size: 14pt;
            transition: background 0.3s ease;
            border: 1px solid #000000;
        }

        .back-link:hover {
            background: #404040;
            border-color: #404040;
        }

        @media (max-width: 768px) {
            .travel-header h1 {
                font-size: 42px;
                line-height: 40pt;
            }
            
            .travel-header p {
                font-size: 14pt;
            }
            
            .stats-container {
                gap: 20px;
            }
            
            .stat-box {
                padding: 15px 25px;
            }
            
            .stat-number {
                font-size: 36px;
            }
            
            #worldMap {
                height: 400px;
            }
            
            .region-title {
                font-size: 28px;
            }
        }
    </style>
</head>
<body>
    <div class="travel-container">
        <div class="travel-header">
            <h1>üåç My Travel Adventures</h1>
            <p>The real voyage of discovery consists not in seeking new landscapes, but in having new eyes.</p>
            <div class="stats-container" id="statsContainer">
                <!-- Stats will be generated automatically from travel data -->
            </div>
        </div>

        <div class="map-container">
            <div id="worldMap"></div>
        </div>

        <div class="regions-grid" id="regionsGrid">
            <!-- Region cards will be generated automatically from travel data -->
        </div>

        <div style="text-align: center;">
            <a href="index.html" class="back-link">‚Üê Back to Home</a>
        </div>
    </div>

    <script src="https://d3js.org/d3.v7.min.js"></script>
    <script src="https://d3js.org/topojson.v3.min.js"></script>
    <script src="travel-data.js"></script>
    <script>
        // ============================================================================
        // ÔøΩ AUTO-GENERATED DATA - Everything updates automatically from travel-data.js
        // ============================================================================
        
        // Flatten all countries and create lookup sets
        const allCountries = Object.values(myTravelData).flat();
        const visitedCountriesNames = new Set(
            allCountries.flatMap(c => [c.name, ...(c.altNames || [])])
        );
        const visitedCountriesById = new Set(allCountries.map(c => c.id));
        
        // Calculate statistics
        const totalCountries = allCountries.length;
        const totalContinents = Object.keys(myTravelData).length;
        const worldCoveragePercent = Math.round((totalCountries / 195) * 100); // ~195 countries in the world

        // Region metadata
        const regionMetadata = {
            asia: { icon: 'üåè', title: 'Asia' },
            europe: { icon: 'üá™üá∫', title: 'Europe' },
            americas: { icon: 'üåé', title: 'Americas' },
            africa: { icon: 'üåç', title: 'Africa' },
            oceania: { icon: 'üåè', title: 'Oceania' }
        };

        // ============================================================================
        // üé® RENDER FUNCTIONS
        // ============================================================================
        
        // Generate statistics boxes
        function renderStats() {
            const statsContainer = document.getElementById('statsContainer');
            statsContainer.innerHTML = `
                <div class="stat-box">
                    <div class="stat-number">${totalCountries}</div>
                    <div class="stat-label">Countries Visited</div>
                </div>
                <div class="stat-box">
                    <div class="stat-number">${totalContinents}</div>
                    <div class="stat-label">Continents</div>
                </div>
                <div class="stat-box">
                    <div class="stat-number">~${worldCoveragePercent}%</div>
                    <div class="stat-label">World Coverage</div>
                </div>
            `;
        }

        // Generate region cards
        function renderRegionCards() {
            const regionsGrid = document.getElementById('regionsGrid');
            regionsGrid.innerHTML = '';
            
            for (const [regionKey, countries] of Object.entries(myTravelData)) {
                if (countries.length === 0) continue; // Skip empty regions
                
                const metadata = regionMetadata[regionKey];
                const card = document.createElement('div');
                card.className = 'region-card';
                
                const countryItems = countries
                    .map(c => `<li class="country-item"><span class="country-flag">${c.flag}</span> ${c.name}</li>`)
                    .join('');
                
                card.innerHTML = `
                    <div class="region-title">
                        <span class="region-icon">${metadata.icon}</span>
                        ${metadata.title}
                    </div>
                    <ul class="country-list">
                        ${countryItems}
                    </ul>
                `;
                
                regionsGrid.appendChild(card);
            }
        }

        // Initialize the page
        renderStats();
        renderRegionCards();

        // ============================================================================
        // üó∫Ô∏è MAP RENDERING
        // ============================================================================

        const width = document.getElementById('worldMap').clientWidth;
        const height = window.innerWidth <= 768 ? 400 : 600;

        const svg = d3.select("#worldMap")
            .append("svg")
            .attr("width", width)
            .attr("height", height);

        // Responsive projection - better centering for mobile
        const isMobile = window.innerWidth <= 768;
        const projection = d3.geoMercator()
            .scale(isMobile ? width / 5.5 : width / 6.5)
            .translate([width / 2, isMobile ? height / 2.2 : height / 1.5]);

        const path = d3.geoPath().projection(projection);

        const tooltip = d3.select("body")
            .append("div")
            .style("position", "absolute")
            .style("background", "rgba(0, 0, 0, 0.85)")
            .style("color", "white")
            .style("padding", "8px 12px")
            .style("border-radius", "3px")
            .style("font-family", "open-sans, sans-serif")
            .style("font-size", "14pt")
            .style("font-weight", "400")
            .style("pointer-events", "none")
            .style("opacity", 0)
            .style("box-shadow", "0 2px 4px rgba(0,0,0,0.2)")
            .style("z-index", "1000");

        // Load and draw map
        d3.json("https://cdn.jsdelivr.net/npm/world-atlas@2/countries-110m.json").then(world => {
            const countries = topojson.feature(world, world.objects.countries);

            // Helper function to check if country is visited
            function isVisited(d) {
                const name = d.properties.name;
                const id = d.id;
                return visitedCountriesNames.has(name) || visitedCountriesById.has(String(id));
            }

            svg.selectAll("path")
                .data(countries.features)
                .enter()
                .append("path")
                .attr("d", path)
                .attr("fill", d => isVisited(d) ? "#5b6abf" : "#d0d0d0")
                .attr("stroke", "#ffffff")
                .attr("stroke-width", 0.5)
                .style("cursor", "pointer")
                .on("mouseover", function(event, d) {
                    const visited = isVisited(d);
                    d3.select(this)
                        .attr("fill", visited ? "#4a5aa0" : "#b0b0b0")
                        .attr("stroke-width", 1.5)
                        .attr("stroke", visited ? "#3d4a85" : "#808080");
                    
                    tooltip.transition()
                        .duration(200)
                        .style("opacity", .95);
                    tooltip.html(d.properties.name + (visited ? " ‚úì" : ""))
                        .style("left", (event.pageX + 15) + "px")
                        .style("top", (event.pageY - 35) + "px");
                })
                .on("mouseout", function(event, d) {
                    const visited = isVisited(d);
                    d3.select(this)
                        .attr("fill", visited ? "#5b6abf" : "#d0d0d0")
                        .attr("stroke-width", 0.5)
                        .attr("stroke", "#ffffff");
                    
                    tooltip.transition()
                        .duration(300)
                        .style("opacity", 0);
                })
                .on("mousemove", function(event) {
                    tooltip
                        .style("left", (event.pageX + 15) + "px")
                        .style("top", (event.pageY - 35) + "px");
                });

            // Log for debugging
            console.log(`Total countries loaded: ${countries.features.length}`);
            console.log(`Visited countries highlighted: ${countries.features.filter(isVisited).length}`);
        }).catch(error => {
            console.error("Error loading map:", error);
            document.getElementById('worldMap').innerHTML = '<p style="color: #ff6b6b; text-align: center; padding: 50px;">Error loading map. Please refresh the page.</p>';
        });

        // Responsive resize - debounced to avoid too many reloads
        let resizeTimer;
        window.addEventListener('resize', function() {
            clearTimeout(resizeTimer);
            resizeTimer = setTimeout(() => {
                location.reload();
            }, 250);
        });
    </script>
</body>
</html>
